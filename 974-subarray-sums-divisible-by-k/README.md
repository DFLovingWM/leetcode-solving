## 题意

给定数组A和数字K。求和为K的子数组的数量。



## 思路

### 1. 前缀和(prefix sum)

先求出前缀和数组 P ，前缀和 P[i] 可以理解为“前 i 个数字的和”，可以表达为：

```js
P[i] = Math.sum(...A[i-1])
```

然后求余数 M = P mod K ，将 M 相同的放在一起：它们可以任意组合、并且每两者相差的部分就是一个和为 K 的子数组。即：

- 如果 P[i] 和 P[i+M] 的余数相等，相差的部分是：A[i, i+M)，这部分的和一定是K的倍数（因为余数相等）。所以这里有 1 个满足的子数组。
- 如果扩展成 3 个(或更多)，比如 P[i]、P[i+M]、P[i+M+N]，则相差的部分有3个子数组，并且它们都满足“和是K的倍数”：
  - P[i] 与 P[i+M] 之间的部分，即：A[i, i+M)
  - P[i] 与 P[i+M+N] 之间的部分，即：A[i, i+M+N)
  - P[i+M] 与 P[i+M+N] 之间的部分，即：A[i+M, i+M+N)

最关键是理解好 Pi 与 Pj 之间的部分就是满足条件的子数组。然后就剩下求数量的事情，不过从这两种情况可以看出，求子数组其实就是每两个P配对而已，即最基本的排列组合的数量：

> Cn = n * (n - 1) / 2



## 拓展思考

### 1. 思考方向

跟一般的：

> 从给定数组中取一些数字组合，求和为K的组合数

不一样，本题要求的是子数组(即原数组中截取一段连续的数组)，所以思考方向是不同的。

### 2. 变换问法

Q：不止是求数量，还要求出所有子数组？

A：那就在将余数相同的 P 比如 P2、P3、P5 放在一起的时候，记录 2、3、5 这几个下标，然后用 N2 的复杂度遍历数组，两两截取原数组即可。

