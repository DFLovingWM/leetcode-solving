# 211. 添加与搜索单词 - 数据结构设计

## 题意

实现一个能够新增与查询单词的数据结构，API有：

- `addWord(word)`：增加一个单词
- `search(pattern)`：查询是否存在符合该模式的单词，其中`pattern`可能是个单词，也可能是个含有`.`（匹配1个任意字符）的模式串

## 思路

难点在于怎么处理`.`的情况。

> 1、Naive思路：数组/Set存储

设N为当前单词数，L为单词平均长度。因为单词的比较过程需要O(L)，线性遍历需要O(N)，所以`search(pattern)`需要O(NL)时间，会TLE。

> 2、根据长度哈希

考虑到比较的时候，首先判断长度是否相等。于是想到，似乎可以将所有单词根据长度进行分桶（哈希）。

该方法目前能够AC，但最坏复杂度其实跟Naive思路一样。

> 3、Trie树

单词存储系统通常可以用Trie树来实现，它花费O(L)的时间实现单词的存取，在单词数较多的情况下，由于哈希法因为冲突而增加耗时，并且Trie树的前缀共用可以省空间，所以综合来说Trie树的性能会更好。

但这里还是需要处理通配符`.`的情况。对于Trie树来说，当匹配到某个结点、并且下一个字符是`.`时，需要穷举26种选择，只要有任意一种选择能走到尽头（成功case），就表示匹配成功。因为需要穷举，涉及到backtrack算法，所以Trie树的`search`不能再用循环实现，而要用递归实现。

时间复杂度最坏是O(26^L)，但是实际上不会这么高，因为一种情况是：单词的前缀已经匹配失败了，后面的通配符根本没有机会穷举，这利用了Trie树的优点，能省下很多时间。

> 4、Set + Backtrack

对于每一个pattern，都backtrack出所有可能的单词、然后都与word匹配。因为没有Trie的前缀匹配的优点，所以backtrack次数会很多，会TLE。
