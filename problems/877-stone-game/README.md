# 877. 石子游戏

## 思路

### 动态规划

博弈游戏，因为这一步的选择会影响之后的局面和选择，并且局部最优不一定导致结果最优，所以是动态规划问题。

在这道题中，求“我”是否能赢，就是要求到游戏结束为止我拿到的石头是否比对方的石头更多。

- Top-down：函数`f(left, right)`表示当前有石头堆`piles[left] ~ piles[right]`、最终我能获取的最大收益。那么状态转移为：`f(left, right) => max( piles[left] - f(left + 1, right), piles[right] - f(left, right - 1) )`，这里做减法是因为下一次轮到对方选了，那么我的收益就是获得的石头数减去对方获得的石头数。并且无论是我还是对方，题目要求都是“聪明”的，即都要取各自的最大收益。
- Bottom-up：`dp[i][j]`表示有石头堆`piles[i] ~ piles[j]`，我的最大收益。当堆数为偶数时、我选，则有转移：`dp[i][j] = max( dp[i+1][j] + piles[i], dp[i][j-1] + piles[j] )`；当堆数为奇数时、对方选，对于我来说是收益减少，于是相应地有：`dp[i][j] = max( dp[i+1][j] - piles[i], dp[i][j-1] - piles[j] )`。虽然一个做加法、一个做减法，但跟Top-down中的做减法本质上是一样的，因为在Top-down中，负负得正，即下一轮是减、隔一轮是加，依此类推。

### 数学分析

因为`N`为偶数，讨论：

- `N=2`：我总能够选更大的那堆，所以可以赢。
- `N=4`：如果我选0，则再次轮到我时，我总能选2；如果我选3，则再次轮到我时，我总能选1。综上，要么选`0、2`，要么选`1、3`，那么我就可以挑更大的那一对，所以可以赢。
- 依此类推

结论：我总能赢。

数学优化就是降维打击，可怕。

## 反思总结

博弈论的动态规划解法的模板题。
