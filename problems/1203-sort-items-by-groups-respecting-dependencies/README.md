# 1203. 项目管理

## 题意

给定`n`个项目所属的组`group`，以及项目的先后关系`beforeItems`，求项目排班，需要满足以下两个条件：

1. 同组项目需要挨在一起
1. 需要满足先后关系

## 思路

如果是单纯根据项目的依赖关系来排序，那么这就是个简单的拓扑排序。然而题目多了一个要求，就是“同组项目需要挨在一起”，那么这里就需要两重的拓扑排序：

1. 首先，组间有拓扑序，对`groups`进行拓扑排序（1次）
1. 其次，对于排序好的每个组，其下所有项目之间也有拓扑序，对`projects`进行拓扑排序（总共`groupNum`次）

除了这个大体思路，本题的难点还在于代码较长。有一些编码要点（代码中有注释，这里稍微整理一下）：

- 题目只给定项目关系`beforeItems`，我们需要通过`group`推导出组间关系
  - 两个组之间可能有重复的边，所以需要用集合来去重，即邻接表结构为`unordered_set<int> groupAdj[groupNum]`，并且注意入度不要在重复情况下加1
  - 如果两个项目属于不同组，只取组间关系（不同组的项目之间不需要项目关系，因为组间关系已经保证了它们最终的先后关系）
  - 如果两个项目属于同组，只取项目关系
- 构建“组 => 项目列表”的映射，以降低时间复杂度（否则需要`O(MN)`遍历来筛选出某个组的所有项目）
- 至于一开始没有归属的项目，虽然题目给定只有`m`个小组，但是最终答案只需要保证同组项目挨在一起，并不需要保证每一“段”都由不同的组来完成，所以一个组完成它的项目之后可以再分配项目。所以一个没有归属的项目，当作单独的项目组来分配即可。
