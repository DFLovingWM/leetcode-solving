# 381. O(1) 时间插入、删除和获取随机元素 - 允许重复

## 题意

题意同380，但是存在重复元素。

## 思路

上一节说的HashMap是“value => index”的映射，这道题由于元素存在重复，需要改为一对多映射。用什么数据结构保存多个index呢？数组吗？

我们暂且用“容器”来代替。重新思考下这个下标容器需要有什么操作：

- insert
  - 增加值
- remove：假设要删除A（下标为a），数组结尾是B（下标为b）。删除之前，先获取A的下标容器中任意一个值，需要将A(a)、B(b)交换位置，即需要在B的下标容器中删除b并增加a，在A的下标容器中删除a。包括：
  - 获取（任意）一个值
  - 删除值
  - 增加值

综上所述操作有：

- 给定值，增加新元素（位置随意）
- 给定值，删除对应元素
- 获取任意一个元素

只有一种数据结构可以满足在O(1)时间，就是`HashSet`。数组不能满足，因为删除目标元素达不到O(1)。

## 反思总结

挑选数据结构的时候，我们会从需求的增删改查方面来考虑。并且，容器中的一个元素可以细分为两个方面：索引、值，那么这4种操作通常细分为：

- 增
  - （给定值）追加新元素（append）
  - （给定索引）在指定位置插入新元素（insert）
- 删
  - 删除尾元素
  - （给定索引）删除指定元素
  - （给定值）删除指定元素
- 改
  - （给定索引）修改指定元素
- 查
  - 给定索引，获取值（Random access，数组天然支持的操作）
  - 给定值，查询索引/是否存在
