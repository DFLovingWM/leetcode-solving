# 304. 二维区域和检索 - 矩阵不可变

## 思路

跟一维数组的思路一样，使用【前缀和】。因为是二维，还涉及到【容斥原理】。

构造函数中对matrix预处理成prefix二维数组，`prefix[i][j]`表示左上角到点`(i-1, j-1)`这个矩形的和。推导公式为：

```js
prefix[i][j] = prefix[i-1][j] + prefix[i][j-1] + matrix[i-1][j-1]
  - prefix[i-1][j-1] // 加重复了，要减掉1个
```

而在求任意矩阵和的时候，同样用到了容斥原理：

```js
range(x1, y1, x2, y2) = prefix[x2][y2] - prefix[x2][y1-1] - prefix[x1-1][y2]
  + prefix[x1-1][y1-1] // 减重复了，要加回来1个
```

另外，注意下标细节处理。

时间复杂度：

- 初始化：O(NM)预处理
- 查询范围和：O(1)
