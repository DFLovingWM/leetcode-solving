# 220. 包含重复元素3

## 题意

给定数组`nums`、整数`K`和`T`，判断是否存在两个相差不超过`K`的下标，它们对应的值相差不超过`T`。最终结果只需要返回true/false。

## 思路

直接读题可能会懵逼，但是结合版本1、2就会有更好的理解，即这里“重复元素”的判定条件：

1. 值：不必相等，只需要相差不大于T
1. 下标：相差不大于K

比起版本2，“值”的判定更松了，由“等值搜索”变成了“范围搜索”，故解法有：

- 有序表 + 二分查找上下界：范围搜索很容易想到二分查找，但是给定的数组并不是有序的，所以需要一个有序表。
  - 有序Map（TreeMap）：值映射到下标，找上下界时，比较下标之差是否不超过K。复杂度为O(NlogN)。
  - 有序Set（TreeSet）：维护一个大小不超过K的TreeSet，复杂度为O(NlogK)。
- 桶：由桶排序启发，设每个桶的大小为`V+1`，则一个桶内的数字相差肯定不超过V。更具体的思路可以直接看`bucket.js`的注释。复杂度为O(N)，很厉害。

## 反思总结

其实这是个“二值问题”，并且是“范围搜索”，很容易可以想到用二分查找，跟：

- [713. 积小于K的子数组，求个数](https://leetcode-cn.com/problems/subarray-product-less-than-k/)
- [209. 和大于等于K的子数组，求最小长度](https://leetcode-cn.com/problems/minimum-size-subarray-sum/)

有点相似，只是这里需要额外维护一个有序表，难度更大一点。

另外，桶排序这个解法，可以说是十分创新了。
