# 775. 全局倒置与局部倒置

## 题意

给定数组，“全局倒置”指逆序对，“局部倒置”指相邻元素之间前者大于后者。问数组的两种倒置的数量是否相等。

## 思路

### 逆序对

“局部倒置”因为只需要比较相邻，所以`O(N)`时间可以求出来。“全局倒置”本质上是逆序对，可以使用归并排序在`O(NlogN)`内求出。最后判断两者是否相等即可。

该思路没有利用“全排列”的条件，故虽然能AC，但肯定不是最优解法。

### 暴力 + DP优化

题目问两者是否相等，其实没必要求出两者的具体数量。

对于每个元素`A[i]`，如果右边存在一个元素`A[j]`（其中`j >= i + 2`）满足`A[i] > A[j]`，那么“全局”就从此永远比“局部”要多了，直接返回false。

暴力法是二重循环，`O(N^2)`肯定会TLE。然而，对于`A[i]`来说，与右边的所有元素进行比较是重复性工作，所以其实找到右边的最小值`min(A[j])`来跟`A[i]`比较即可，所以优化思路就是预处理出“前缀最小值”（DP思想），最终时间复杂度为`O(N)`。

### 数学（归纳）法

我们将两种倒置的一个全排列称为“合法”序列。

既然是一个全排列，那么我们考虑逐一放置`[0, n-1]`这`n`个数字，将其视为一个问题`F(0, n-1)`：

首先考虑`0`：如果`0`放在`i>=2`处，那么由于`A[0] > A[i] = 0`，这不合法；所以`0`只能放在`i=0`或`i=1`处。

接着考虑`1`：

- 如果`0`放在`i=0`处，那么之后的`[1, n-1]`这`n-1`个数字是一个与`0`无关的子问题`F(1, n-1)`。
- 如果`0`放在`i=1`处，那么`1`只能放在`i=0`处，因为如果放在`i>=2`，又会存在`A[0] > A[i] = 1`，不合法。于是之后的`[2, n-1]`是子问题`F(2, n-1)`，它不再与`0`、`1`有关。

综上，可以得出结论：对于任意的`i`，只有当`abs(A[i] - i) <= 1`时，该序列才合法。
