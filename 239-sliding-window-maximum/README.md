# 239. 滑动窗口最大值

## 题意

给定一个数组`nums`和窗口大小`K`，求窗口内从左到右滑动的过程中的最大值。

## 思路

暴力法：对于每个窗口，都线性遍历寻找max，总共O(NK)时间。

但是窗口的移动，只是删除了头元素、同时增加尾元素罢了，并不需要单纯地重新遍历整个窗口。所以，需求是进行以下操作，并且单操作少于O(K)：

- 删除某个元素
- 增加元素
- 获取集合的最大值（核心）

所以可以考虑的思路有：

- 有序表（TreeMap）：可以，单操作时间为O(logK)。
- 堆：不可以，因为堆只能删除“最值”，而删除特定元素的操作需要O(K)时间去定位。
- 单调队列。

详细地说说【单调队列】法。这里需要借助双端队列（Deque）这个数据结构，然后我们维护它的单调递减性，即头元素是最大的。有以下操作：

- `push(x)`：在尾部加入新元素x
  - 实现：弹出back、直到队列为空或x小于back，然后加入x。这样可以保持单调递减。
  - 时间复杂度：O(K)
- `pop(x)`：在头部删除元素x
  - 实现：如果front等于x才弹出，否则无操作。
  - 时间复杂度：O(1)
- `getMax()`：获取容器内的最大值
  - 实现：返回front即可。
  - 时间复杂度：O(1)

解释一下：

- push操作中，在加入x之前要将小于x的元素全部删除掉，是因为这些比x小的元素，它们的“寿命”也比x短（因为窗口向右移动，左边的元素比右边的元素先退出窗口），在x存在期间不可能是最大值，所以可以直接删掉。
- pop操作是带参数的，`pop(x)`表示“尝试删除最大值x”，因为非最大值Y从左边退出窗口时，对结果无影响，同时因为push的一顿操作，队列中早已不存在Y这个元素了，所以这时不必操作；而当最大值X从左边退出窗口时，需要选出下一个最大值，所以这时候需要将X从队列头删除，因为单调递减，新的队列头就是下一个最大值。

总体时间复杂度：乍一看，似乎是O(NK)，但对于队列来说，数组中的每个元素都分别进队、出队1次，所以是O(2N)次操作，最终时间为O(N)。
